<!DOCTYPE html>
<html>
<head>

    <title>Team Battles</title>
    <meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href='https://fonts.googleapis.com/css?family=Sigmar+One' rel='stylesheet' type='text/css'>
    <style>
 
        body {
            background-color: rgba(0, 0, 0, 0);
            overflow: hidden;
        }
		
        div .info{
			color: #dddddd;
			text-shadow: 0 0 3px #000000, 0 0 6px #000000;
            display: block;
            float: left;
			font-size: 12px;
			font-family: Verdana;
			height: 12px;
			padding-top: 2px;
        }
    </style>
</head>
<body>
    <audio autoplay>
        <source src="Ding.mp3" type="audio/mpeg">
    </audio>
    <div class="spacer"></div>
 
    <div id="navContent">
<div style="width:360px;height:110px;">
 <div style = "width: 100%; height: 100%;display: inline-block;">
 
				<div class ="info" style="padding-left: 0px; font-weight: bold;" id="0-game-name">Game</div>

				<div class ="info" style="padding-left: 25px; font-weight: bold;">State: </div>
				<div class = "info" style="padding-left: 10px;font-weight: bold;" id="state-slot">None</div>
				<div class ="info" style="padding-left: 25px; font-weight: bold;">By: </div>
				<div class = "info" style="padding-left: 10px;font-weight: bold;" id="submitter">Name</div>				
				<div class = "info" style="width: 10px;"></div>
			
				<br><br>

			<!-- <div class ="info" style="font-weight: bold;">Details: </div> !-->
                <div class ="info" style="padding-left: 0px;font-weight: bold;"id="challenge-details">Stuff</div>
				
			<!--	<div class ="info" style="padding-left: 0px; font-weight: bold;" id="0-challenge">TB#</div>!-->

			<!---	<div class = "info" style="width: 10px; border-right: thick double #888888; border-bottom: thick double #888888;border-top: thick double #888888;"></div> !-->
    </div>
</div>
	
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
    var isCalled = false;
	function isNotGenesis(value) {
		return value.GameConsole.indexOf("Genesis") <= -1;
	}
	function isSaveState(value) {
		return value.SaveStateDownloadLocation.indexOf("X") > -1;
	}
    $challenge = {
        loadJSON: function (path, callback) {
            var xobj = new XMLHttpRequest();
            xobj.overrideMimeType("application/json");
            xobj.open('GET', path, true);
            xobj.onreadystatechange = function () {
                if (xobj.readyState == 4 && xobj.status == "200") {
                    callback(xobj.responseText);
                }
            };
            xobj.send(null);
        },
        loadGame: function (path) {
            if (!isCalled) {
                isCalled = true;
                $challenge.loadJSON(path, function (response) {
                    var challenges = JSON.parse(response);
					var filteredChallenges = challenges.filter(isNotGenesis);
				    filteredChallenges = filteredChallenges.filter(isSaveState);
                    // $('#navContent')
                    for (var i = 0; i < 1; i++) {
                        var challenge = filteredChallenges[Math.floor(Math.random() * filteredChallenges.length)];
                        $('#' + i + '-game-name').text(challenge.GameTitle);
						$('#' + i).text(challenge.GameTitle);
						$('#' + i + '-challenge').text(challenge.TBKey);
						$('#game-console').text(challenge.GameConsole)
						$('#submitter').text(challenge.Submitter)
						$('#challenge-details').text(challenge.ChallengeDetails)
						$('#state-slot').text(challenge.Stateslot)
                    }
                });
            }
        }
    }
    window.onload = function () {
        $challenge.loadGame('TB challenges.json');
    }
</script>
</body>
</html>